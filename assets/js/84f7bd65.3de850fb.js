"use strict";(self.webpackChunksuberra_docs=self.webpackChunksuberra_docs||[]).push([[257],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>f});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=c(n),f=o,m=d["".concat(l,".").concat(f)]||d[f]||u[f]||a;return n?r.createElement(m,i(i({ref:t},p),{},{components:n})):r.createElement(m,i({ref:t},p))}));function f(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:o,i[1]=s;for(var c=2;c<a;c++)i[c]=n[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},3214:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>d,frontMatter:()=>i,metadata:()=>l,toc:()=>p});var r=n(7462),o=(n(7294),n(3905));const a=n.p+"assets/images/periodic_allowance-02ed7dcc3ee66ff0df8f297e548a1da2.png",i={title:"How Suberra Works",description:"Periodic allowances",slug:"/overview/periodic-allowances"},s=void 0,l={unversionedId:"overview/how_suberra_works",id:"overview/how_suberra_works",title:"How Suberra Works",description:"Periodic allowances",source:"@site/docs/0_overview/how_suberra_works.mdx",sourceDirName:"0_overview",slug:"/overview/periodic-allowances",permalink:"/suberra-docs/docs/overview/periodic-allowances",draft:!1,editUrl:"https://github.com/suberra/suberra-docs/docs/0_overview/how_suberra_works.mdx",tags:[],version:"current",frontMatter:{title:"How Suberra Works",description:"Periodic allowances",slug:"/overview/periodic-allowances"},sidebar:"docs",previous:{title:"Suberra for Merchants",permalink:"/suberra-docs/docs/overview/what_is_suberra"},next:{title:"Use Cases",permalink:"/suberra-docs/docs/overview/use_cases"}},c={},p=[{value:"Our Solution: Periodic allowances",id:"our-solution-periodic-allowances",level:2},{value:"Technical Specifications",id:"technical-specifications",level:2},{value:"<code>approve</code>",id:"approve",level:3},{value:"<code>permit</code>",id:"permit",level:3},{value:"<code>transferFrom</code>",id:"transferfrom",level:3},{value:"<code>allowanceInfo</code>",id:"allowanceinfo",level:3}],u={toc:p};function d(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("hr",null),(0,o.kt)("p",null,"Most dApps require users to grant an allowance to spend tokens before any transactions on the dApp are possible. For example, if you are trying to trade on Uniswap, Uniswap will require you to approve their contracts to spend tokens on your behalf."),(0,o.kt)("p",null,"This is done by calling the ",(0,o.kt)("inlineCode",{parentName:"p"},"approve")," function on the token contract. The ",(0,o.kt)("inlineCode",{parentName:"p"},"approve")," function takes two arguments:"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"address")," : The address of the spender (the contract that will be spending the tokens on your behalf)"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"amount")," : The amount of tokens to be approved (the maximum amount of tokens that can be spent by the spender)"),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"approve")," function is a one-time function, meaning that you can only call it once. If you want to change the amount of tokens that can be spent by the spender, you will have to call the ",(0,o.kt)("inlineCode",{parentName:"p"},"approve")," function again with the new amount."),(0,o.kt)("p",null,"This is a security feature to prevent dApps from stealing your tokens. However, it is a very inconvenient UX for users, since they have to approve the dApp every time they want to use it."),(0,o.kt)("p",null,"As a result, many developers of programs that are designed to repeat the same actions over time choose to request for a large (or unlimited) approval from the user, for a better UX. This is ofcourse a bad practice - a huge ",(0,o.kt)("strong",{parentName:"p"},"security risk"),". The funds in the users wallets can be drained completely if the developer is malicious, or if the dApp is compromised."),(0,o.kt)("h2",{id:"our-solution-periodic-allowances"},"Our Solution: Periodic allowances"),(0,o.kt)("div",{style:{flexBasis:"300px",flexGrow:"1",textAlign:"center"}},(0,o.kt)("img",{src:a,style:{alignSelf:"center",maxWidth:"100%"}})),(0,o.kt)("p",null,"Suberra protects users by building another layer of stricter constraints on EIP-20 allowances. These constraints restrict the amount of tokens that can be spent by the dApp. This is done by setting a maximum allowance that can be spent in a period of time (e.g. 50 USDC per month). Once the smart contract uses up the allowance for the given period of time, it can no longer spend any tokens from the user's wallet. This periodic allowance is reset upon the next unit interval."),(0,o.kt)("h2",{id:"technical-specifications"},"Technical Specifications"),(0,o.kt)("h3",{id:"approve"},(0,o.kt)("inlineCode",{parentName:"h3"},"approve")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"function approve(\n        address token,\n        address spender,\n        uint192 amount,\n        uint64 duration,\n        uint64 startTime\n    )\n")),(0,o.kt)("h3",{id:"permit"},(0,o.kt)("inlineCode",{parentName:"h3"},"permit")),(0,o.kt)("p",null,'Supports EIP-20 approvals ("permits") via EIP-712 secp256k1 signatures'),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"    function permit(\n        address owner,\n        address token,\n        address spender,\n        uint192 amount,\n        uint64 duration,\n        uint64 startTime,\n        uint256 deadline,\n        uint8 v,\n        bytes32 r,\n        bytes32 s\n    )\n    ```\n")),(0,o.kt)("h3",{id:"transferfrom"},(0,o.kt)("inlineCode",{parentName:"h3"},"transferFrom")),(0,o.kt)("p",null,"Transfers the underlying token from owner to recipient. Owner should have given approved the periodic allowance contract to spend tokens on his behalf for the designated token."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"    function transferFrom(\n        address token,\n        address owner,\n        address recipient,\n        uint192 amount\n    )\n")),(0,o.kt)("h3",{id:"allowanceinfo"},(0,o.kt)("inlineCode",{parentName:"h3"},"allowanceInfo")),(0,o.kt)("p",null,"Gets the current allowance information given the owner, token and spender."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"  function allowanceInfo(\n        address owner,\n        address token,\n        address spender\n    )\n")))}d.isMDXComponent=!0}}]);